<!DOCTYPE html>
<html lang="en">
<<<<<<< HEAD

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendaftaran</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
=======
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendaftaran</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
>>>>>>> 4f8475eac47e8e8964e403da70d1548cd91e43a1
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
<<<<<<< HEAD
        $(document).ready(function () {
            // Fungsi untuk menampilkan tabel berdasarkan data yang diberikan
            function renderTable(data) {
                let tbody = $("#antrian-container tbody");
                tbody.empty();
    
                data.forEach(function (item, index) {
                    let row = $("<tr>");
    
                    row.append("<td>" + (index + 1) + "</td>");
                    row.append("<td>" + item.name + "</td>");
                    row.append("<td>" + item.nik + "</td>");
                    row.append("<td>" + item.tanggal + "</td>");
                    row.append("<td>" + item.status + "</td>");
    
                    tbody.append(row);
                });
            }
    
            // Fungsi untuk menampilkan atau menyembunyikan formulir dan antrian berdasarkan data
            function toggleFormAndAntrian(hasPendingOrApproved) {
                if (hasPendingOrApproved) {
                    $("#formulir-container").hide();
                    $("#antrian-container").show();
                } else {
                    $("#formulir-container").show();
                    $("#antrian-container").hide();
                }
            }
    
            // Klik peristiwa untuk mengirim formulir
            $(".btn-submit-form").click(function (event) {
                event.preventDefault();
                let poli = $("#poli").val();
                let tanggal = $("#tanggal").val();
                let keluhan = $("#keluhan").val();
    
                var formData = {
                    poli: poli,
                    tanggal: tanggal,
                    keluhan: keluhan,
                    submit: "submit",
                };
    
                if (formData.poli === "") {
                    alert("Harap pilih jenis poli sebelum mengirim formulir");
                    return;
                }
    
                if (formData.tanggal === "") {
                    alert("Harap pilih tanggal berobat sebelum mengirim formulir");
                    return;
                }
    
                if (formData.keluhan === "") {
                    alert("Harap isi keluhan Anda sebelum mengirim formulir");
                    return;
                }
    
                // Permintaan Ajax untuk mengirim formulir
                $.ajax({
                    type: "POST",
                    url: "/pendaftaran_formulir",
                    data: formData,
                    success: function (data) {
                        alert("Formulir telah diproses. Silakan tunggu");
                        // Mengasumsikan 'data' memiliki struktur { antrian_data: [...] }
                        toggleFormAndAntrian(true);
                        renderTable(data.antrian_data);
                    },
                    error: function () {
                        alert("Gagal melakukan pendaftaran");
                    },
                });
            });
        });
    </script>
    
</head>
=======
      $(document).ready(function () {
        // Menampilkan atau menyembunyikan formulir dan antrian
        function toggleFormAndAntrian(hasPendingOrApproved) {
          if (hasPendingOrApproved) {
            // Jika ada pendaftaran dengan status pending/approve, tampilkan antrian
>>>>>>> 4f8475eac47e8e8964e403da70d1548cd91e43a1

            // change css display of formulir-container to none
            // $("#formulir-container").css("display", "none!important");
            $("#formulir-container").hide();
            $("#antrian-container").show();
            console.log("hide");
          } else {
            // Jika tidak ada, tampilkan formulir
            $("#formulir-container").show();
            $("#antrian-container").hide();
          }
        }

        // // Untuk menampilkan atau menyembunyikan formulir dan antrian saat halaman dimuat
        // $.ajax({
        //     type: 'POST',
        //     url: '/pendaftaran_formulir',
        //     success: function (data) {
        //         console.log(data)
        //         console.log("Has Pending or Approved: " + data.has_pending_or_approved);
        //         toggleFormAndAntrian(data.has_pending_or_approved);
        //     },
        //     error: function () {
        //         console.error('Gagal mendapatkan status pendaftaran');
        //     }
        // });

        $(".btn-submit-form").click(function (event) {
          event.preventDefault();
          let poli = $("#poli").val();
          let tanggal = $("#tanggal").val();
          let keluhan = $("#keluhan").val();

          // Dapatkan data formulir
          var formData = {
            poli: poli,
            tanggal: tanggal,
            keluhan: keluhan,
            submit: "submit",
          };

          if (formData.poli === "") {
            alert("Harap pilih jenis poli sebelum mengirim formulir");
            return;
          }

          if (formData.tanggal === "") {
            alert("Harap pilih tanggal berobat sebelum mengirim formulir");
            return;
          }

          if (formData.keluhan === "") {
            alert("Harap isi keluhan Anda sebelum mengirim formulir");
            return;
          }

          $.ajax({
            type: "POST",
            url: "/pendaftaran_formulir",
            data: formData,
            success: function () {
              alert("Formulir telah diproses. Silakan tunggu");
              toggleFormAndAntrian(true);
            },
            error: function () {
              alert("Gagal melakukan pendaftaran");
            },
          });
        });
      });
    </script>
  </head>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
      <a class="navbar-brand">Klinik Google</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="#">Pendaftaran</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Riwayat Pendaftaran</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Riwayat Check-up</a>
          </li>
          <li class="nav-item">
            <span class="nav-link disabled">{{ user_info.name }}</span>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Formulir Pendaftaran -->
    <div id="formulir-container">
<<<<<<< HEAD
        <div class="container mt-5 d-flex justify-content-center">
            <div class="card" style="width: 500px">
                <h3 class="card-title text-center mt-3">Formulir Pendaftaran</h3>
                <div class="card-body">
                    <form action="/pendaftaran_formulir" method="POST">

                        <div class="form-group">
                            <label for="poli" class="mr-2"> Poli </label>
                            <select class="form-control" id="poli" name="poli">
                                <option value="" selected disabled>Pilih Poli</option>
                                <option value="poli_umum">Poli Umum</option>
                                <option value="poli_gigi">Poli Gigi</option>
                                <option value="poli_mata">Poli Mata</option>
                                <option value="poli_anak">Poli Anak</option>
                                <option value="poli_gizi">Poli Gizi</option>
                                <option value="poli_jantung">Poli Jantung</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="tanggal" class="mr-2"> Tanggal Berobat </label>
                            <input type="date" class="form-control" id="tanggal" name="tanggal" />
                        </div>

                        <div class="form-group">
                            <label for="keluhan" class="mr-2"> Keluhan </label>
                            <textarea class="form-control" id="keluhan" name="keluhan" rows="3"></textarea>
                        </div>

                        <div class="d-flex justify-content-end">
                            <button type="submit" class="btn btn-primary btn-submit-form">
                                Kirim
                            </button>
                        </div>
                    </form>
                </div>
            </div>
=======
      <div
        class="container mt-5 d-flex justify-content-center"
        
      >
        <div class="card" style="width: 500px">
          <h3 class="card-title text-center mt-3">Formulir Pendaftaran</h3>
          <div class="card-body">
            <form action="/pendaftaran_formulir" method="POST">
              <div class="form-group">
                <label for="poli" class="mr-2"> Poli </label>
                <select class="form-control" id="poli" name="poli">
                  <option value="" selected disabled>Pilih Poli</option>
                  <option value="poli_umum">Poli Umum</option>
                  <option value="poli_gigi">Poli Gigi</option>
                  <option value="poli_mata">Poli Mata</option>
                  <option value="poli_anak">Poli Anak</option>
                  <option value="poli_gizi">Poli Gizi</option>
                  <option value="poli_jantung">Poli Jantung</option>
                </select>
              </div>

              <div class="form-group">
                <label for="tanggal" class="mr-2"> Tanggal Berobat </label>
                <input
                  type="date"
                  class="form-control"
                  id="tanggal"
                  name="tanggal"
                />
              </div>

              <div class="form-group">
                <label for="keluhan" class="mr-2"> Keluhan </label>
                <textarea
                  class="form-control"
                  id="keluhan"
                  name="keluhan"
                  rows="3"
                ></textarea>
              </div>

              <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary btn-submit-form">
                  Kirim
                </button>
              </div>
            </form>
          </div>
>>>>>>> 4f8475eac47e8e8964e403da70d1548cd91e43a1
        </div>
      </div>
    </div>

    <!-- Antrian Pendaftaran -->
    <div class="container mt-5" id="antrian-container" style="display: none">
<<<<<<< HEAD
        <h3 class="text-center">Antrian Pendaftaran</h3>
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">No Urut</th>
                    <th scope="col">Nama</th>
                    <th scope="col">NIK</th>
                    <th scope="col">Tanggal</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody>
                {% for data in data %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ data.name }}</td>
                    <td>{{ data.nik }}</td>
                    <td>{{ data.tanggal }}</td>
                    <td>{{ data.status }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>

</html>
=======
      <h3 class="text-center">Antrian Pendaftaran</h3>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">No Urut</th>
            <th scope="col">Nama</th>
            <th scope="col">NIK</th>
            <th scope="col">Tanggal</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody>
          {% for data in data %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ data.name }}</td>
            <td>{{ data.nik }}</td>
            <td>{{ data.tanggal }}</td>
            <td>{{ data.status }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
>>>>>>> 4f8475eac47e8e8964e403da70d1548cd91e43a1
