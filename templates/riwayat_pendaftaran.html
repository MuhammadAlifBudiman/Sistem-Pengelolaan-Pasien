<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Riwayat Pendaftaran</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"
    ></script>
    <script>
      $(document).ready(function () {
        // Inisialisasi DataTables
        let myTable = $("#myTable").DataTable();

        // Ambil data riwayat pendaftaran
        $.ajax({
          url: "/api/riwayat_pendaftaran",
          type: "GET",
          success: function (data) {
            // Isi tabel riwayat pendaftaran
            myTable.clear().draw();
            data.riwayat.forEach(function (row, index) {
              myTable.row
                .add([
                  index + 1,
                  row.name,
                  row.nik,
                  row.poli,
                  row.tanggal,
                  row.status,
                ])
                .draw(false);
            });
          },
        });
      });

      function sign_out() {
        $.removeCookie("mytoken", { path: "/" });
        alert("Logged out!");
        window.location.href = "/";
      }
    </script>
  </head>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
      <a class="navbar-brand ms-4" style="color: #06a3da"
        ><span style="color: #091e3e">Klinik</span> Google</a
      >
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/pendaftaran">Pendaftaran</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/riwayat_pendaftaran"
              >Riwayat Pendaftaran</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/riwayat_checkup">Riwayat Check-up</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/profile">{{ user_info.name }}</a>
          </li>
          <li class="nav-item">
            <button
              class="btn text-light"
              onclick="sign_out()"
              style="background-color: #f57e57"
            >
              Logout
            </button>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container mt-5 pt-5">
      <div class="card">
        <div class="card-header">
          <h3 class="text-center text-primary">Riwayat Pendaftaran</h3>
        </div>
        <div class="card-body">
          <table class="table table-hover table-bordered border-primary" style="
          border-collapse: collapse;" id="myTable">
            <thead>
              <tr>
                <th scope="col">No</th>
                <th scope="col">Nama</th>
                <th scope="col">NIK</th>
                <th scope="col">Poli</th>
                <th scope="col">Tanggal</th>
                <th scope="col">Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
